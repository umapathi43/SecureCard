<section id="ngx-datatable-filter">
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-content">
          <div class="card-header">
            <h4>Bulk creation</h4>
          </div>
          <div class="card-body">
            <form #userForm="ngForm">
              <!-- ngx-datatable-filter -->
              <fieldset class="form-group">
                <label for="ngx-filter-ref"
                  >Search:
                  <input
                    id="ngx-filter-ref"
                    class="form-control form-control-sm d-inline-block width-200"
                    type="text"
                    placeholder="Filter the Name column..."
                  />
                </label>
              </fieldset>
              <ngx-datatable
                class="bootstrap core-bootstrap opening-stock"
                style="height: 400px"
                [columns]="columns2"
                [columnMode]="ColumnMode.force"
                [headerHeight]="50"
                [rowHeight]="50"
                [rows]="Items"
                [externalPaging]="false"
                [scrollbarH]="true"
                [scrollbarV]="true"
              >
                <ngx-datatable-column
                  name="Name"
                  prop="supplierName"
                  [width]="130"
                >
                  <ng-template
                    let-item="row"
                    ngx-datatable-cell-template
                    let-rowIndex="rowIndex"
                  >
                    <input
                      type="text"
                      id="hidden-label-form-1"
                      class="form-control"
                      name="cname{{ rowIndex }}"
                      [(ngModel)]="item.supplierName"
                      #name="ngModel"
                      [ngClass]="{
                        'is-invalid': userForm.submitted && name.invalid,
                        'is-valid': userForm.submitted && !name.invalid
                      }"
                      required
                    />
                    <div
                      *ngIf="
                        userForm.submitted &&
                        (name.invalid || name.errors?.required)
                      "
                      class="invalid-tooltip"
                    >
                      Please provide a valids Name.
                    </div>
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column
                  name="Mobile"
                  prop="mobileNo"
                  [width]="160"
                >
                  <ng-template
                    let-item="row"
                    ngx-datatable-cell-template
                    let-rowIndex="rowIndex"
                  >
                    <input
                      type="tel"
                      id="hidden-label-form-2"
                      class="form-control"
                      name="mobile{{ rowIndex }}"
                      [(ngModel)]="item.mobileNo"
                      #name="ngModel"
                      (keypress)="mobileNumber($event)"
                      maxlength="13"
                      [ngClass]="{
                        'is-invalid': userForm.submitted && name.invalid,
                        'is-valid': userForm.submitted && !name.invalid
                      }"
                      required
                    />
                    <div
                      *ngIf="
                        userForm.submitted &&
                        (name.invalid || name.errors?.required)
                      "
                      class="invalid-tooltip"
                    >
                      Please provide a valid mobile number.
                    </div>
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column
                  name="Address"
                  prop="address1"
                  [width]="160"
                >
                  <ng-template
                    let-item="row"
                    ngx-datatable-cell-template
                    let-rowIndex="rowIndex"
                  >
                    <input
                      type="text"
                      id="hidden-label-form-3"
                      class="form-control"
                      name="address1{{ rowIndex }}"
                      [(ngModel)]="item.address1"
                      #name="ngModel"
                      [ngClass]="{
                        'is-invalid': userForm.submitted && name.invalid
                      }"
                      required
                    />
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column
                  name="GSTNo"
                  prop="address1"
                  [width]="160"
                >
                  <ng-template
                    let-item="row"
                    ngx-datatable-cell-template
                    let-rowIndex="rowIndex"
                  >
                    <input
                      type="text"
                      id="hidden-label-form-4"
                      class="form-control pickadate"
                      name="gstNo{{ rowIndex }}"
                      [(ngModel)]="item.gstNo"
                      #name="ngModel"
                      pattern="^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$"
                      [ngClass]="{
                        'is-invalid': userForm.submitted && name.invalid
                      }"
                      (ngModelChange)="item.gstNo = $event.toUpperCase()"
                      (change)="gstValidation(name.errors?.pattern)"
                    />
                    <small
                      class="form-text text-muted danger"
                      *ngIf="name.errors?.pattern"
                      >Required Valid GST Number</small
                    >
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column
                  name="Gst Type"
                  prop="gstType"
                  [width]="160"
                >
                  <ng-template
                    let-item="row"
                    ngx-datatable-cell-template
                    let-rowIndex="rowIndex"
                  >
                    <select
                      id="basic-form-6"
                      class="form-control"
                      name="gstType{{ rowIndex }}"
                      [(ngModel)]="item.gstType"
                      #name="ngModel"
                      [ngClass]="{
                        'is-invalid': userForm.submitted && name.invalid
                      }"
                    >
                      <option value="none" selected disabled>GST Type</option>
                      <option
                        *ngFor="let item of gstTypeList"
                        value="{{ item.id }}"
                      >
                        {{ item.gstTypeName }}
                      </option>
                    </select>
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column
                  name="Discount"
                  prop="discount"
                  [width]="160"
                >
                  <ng-template
                    let-item="row"
                    ngx-datatable-cell-template
                    let-rowIndex="rowIndex"
                  >
                    <input
                      type="number"
                      id="hidden-label-form-5"
                      class="form-control"
                      name="discount{{ rowIndex }}"
                      [(ngModel)]="item.discount"
                      #name="ngModel"
                      [ngClass]="{
                        'is-invalid': userForm.submitted && name.invalid
                      }"
                    />
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column
                  name="Rate Slab"
                  prop="rateSlab"
                  [width]="160"
                >
                  <ng-template
                    let-item="row"
                    ngx-datatable-cell-template
                    let-rowIndex="rowIndex"
                  >
                    <input
                      type="number"
                      id="hidden-label-form-5"
                      class="form-control"
                      name="rateSlab{{ rowIndex }}"
                      [(ngModel)]="item.rateSlab"
                      #name="ngModel"
                      [ngClass]="{
                        'is-invalid': userForm.submitted && name.invalid
                      }"
                    />
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column
                  name="Mode of Payment"
                  prop="modeOfPayment"
                  [width]="160"
                >
                  <ng-template
                    let-item="row"
                    ngx-datatable-cell-template
                    let-rowIndex="rowIndex"
                  >
                    <select
                      id="basic-form-6"
                      name="interested"
                      class="form-control"
                      name="modeOfPayment{{ rowIndex }}"
                      [(ngModel)]="item.modeOfPayment"
                      #name="ngModel"
                      [ngClass]="{
                        'is-invalid': userForm.submitted && name.invalid
                      }"
                    >
                      <option value="none" selected disabled>
                        Mode of Payment
                      </option>
                      <option
                        *ngFor="let item of paymentMethodList"
                        value="{{ item.id }}"
                      >
                        {{ item.paymentModeName }}
                      </option>
                    </select>
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column
                  name="openingBal"
                  prop="openingBal"
                  [width]="160"
                >
                  <ng-template
                    let-item="row"
                    ngx-datatable-cell-template
                    let-rowIndex="rowIndex"
                  >
                    <input
                      type="number"
                      id="hidden-label-form-5"
                      class="form-control"
                      name="balance{{ rowIndex }}"
                      [(ngModel)]="item.openingBal"
                      #name="ngModel"
                      required
                    />
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column
                  name="openingBalDate"
                  prop="openingBalDate"
                  [width]="160"
                >
                  <ng-template
                    let-item="row"
                    ngx-datatable-cell-template
                    let-rowIndex="rowIndex"
                  >
                    <input
                      type="date"
                      id="hidden-label-form-5"
                      class="form-control"
                      name="openingBalDate{{ rowIndex }}"
                      [(ngModel)]="item.openingBalDate"
                      #name="ngModel"
                      required
                    />
                  </ng-template>
                </ngx-datatable-column>
                <ngx-datatable-column name="Actions">
                  <ng-template
                    let-item="row"
                    ngx-datatable-cell-template
                    let-rowIndex="rowIndex"
                    [width]="100"
                  >
                    <a
                      *ngIf="rowIndex != Items.length - 1 || Items.length > 1"
                      (click)="removeItem(rowIndex)"
                      ><i class="ft-trash text-danger cursor-pointer"></i
                    ></a>
                  </ng-template>
                </ngx-datatable-column>
              </ngx-datatable>
              <button
                type="button"
                class="btn btn-primary btn-sm"
                (click)="addItem()"
              >
                Add Item
              </button>
            </form>

            <!-- ngx-datatable-filter -->
          </div>
          <div class="card-footer">
            <button
              type="submit"
              class="btn btn-primary mr-2"
              (click)="onSubmit()"
            >
              <i class="ft-check-square mr-1"></i>
              Save
            </button>

            <button type="button" class="btn btn-secondary" (click)="goBack()">
              <i class="ft-x mr-1"></i>Cancel
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
